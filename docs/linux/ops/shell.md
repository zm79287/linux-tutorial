# ???????????????? shell ????

> ???? bash ?? Linux ??????? shell ????????????? bash ?? shell ?????????
>
> ??????????? bash ?????????? linux ??????¶ ¶Õ????
>
> :notebook: ??????˘r??????[blog](https://github.com/dunwu/blog)??
> :keyboard: ??????????˘r?? [linux-tutorial](https://github.com/dunwu/linux-tutorial/tree/master/codes/shell/demos)

```
???????????????[?????[  ?????[???????????????[?????[     ?????[
?????X?T?T?T?T?a?????U  ?????U?????X?T?T?T?T?a?????U     ?????U
???????????????[???????????????U???????????[  ?????U     ?????U
?^?T?T?T?T?????U?????X?T?T?????U?????X?T?T?a  ?????U     ?????U
???????????????U?????U  ?????U???????????????[???????????????[???????????????[
```

<!-- TOC depthFrom:2 depthTo:3 -->

- [1. ???](#1-???)
    - [1.1. ???? shell](#11-????-shell)
    - [1.2. ???? shell ???](#12-????-shell-???)
    - [1.3. Shell ????](#13-shell-????)
    - [1.4. ??](#14-??)
- [2. ??????](#2-??????)
    - [2.1. ??????](#21-??????)
    - [2.2. ???](#22-???)
    - [2.3. echo](#23-echo)
    - [2.4. printf](#24-printf)
- [3. ????](#3-????)
    - [3.1. ???????????](#31-???????????)
    - [3.2. ????????](#32-????????)
    - [3.3. ???????](#33-???????)
    - [3.4. ???????](#34-???????)
    - [3.5. ????????](#35-????????)
    - [3.6. ??????????](#36-??????????)
- [4. ?????](#4-?????)
    - [4.1. ????????????](#41-????????????)
    - [4.2. ????????](#42-????????)
    - [4.3. ????????????](#43-????????????)
    - [4.4. ??????????](#44-??????????)
    - [4.5. ???????????](#45-???????????)
    - [4.6. ???????????](#46-???????????)
- [5. ????](#5-????)
    - [5.1. ????????](#51-????????)
    - [5.2. ???????????](#52-???????????)
    - [5.3. ???????¯A??](#53-???????¯A??)
    - [5.4. ??????????????](#54-??????????????)
    - [5.5. ??????????????](#55-??????????????)
    - [5.6. ??????????](#56-??????????)
- [6. ?????](#6-?????)
    - [6.1. ?????????](#61-?????????)
    - [6.2. ????????](#62-????????)
    - [6.3. ?????????](#63-?????????)
    - [6.4. ????????](#64-????????)
    - [6.5. ??????????](#65-??????????)
    - [6.6. ????????????](#66-????????????)
- [7. ???????](#7-???????)
    - [7.1. ???????](#71-???????)
    - [7.2. ??????](#72-??????)
- [8. ????](#8-????)
    - [8.1. ¶À?®∞???](#81-¶À?®∞???)
    - [8.2. ???????????](#82-???????????)
- [9. Shell ???](#9-shell-???)
- [10. ?????????](#10-?????????)
    - [10.1. ?????????](#101-?????????)
    - [10.2. ?????](#102-?????)
    - [10.3. `/dev/null` ???](#103-devnull-???)
- [11. Debug](#11-debug)
- [12. ????????](#12-????????)

<!-- /TOC -->

## 1. ???

### 1.1. ???? shell

- Shell ??????? C ?????ß’??????????????? Linux ????????
- Shell ??????????????????????????????????
- Shell ????????®Æ????????®Æ?????????????ó®???????????????? Linux ???????

Ken Thompson ?? sh ?????? Unix Shell??Windows Explorer ????????????¶Õ??? Shell??

### 1.2. ???? shell ???

Shell ?????shell script?????????? shell ??ß’?????????????????? `.sh`??

???????? shell ???????? shell ??????? shell ?? shell script ?????????????˛ü

### 1.3. Shell ????

Shell ???? java??php ??????????????????ß’????????????????????????ß÷?????????????????

Shell ?????????????????????ßµ?

- [sh](https://www.gnu.org/software/bash/) - ?? Bourne Shell??sh ?? Unix ??????? shell??
- [bash](https://www.gnu.org/software/bash/) - ?? Bourne Again Shell??bash ?? Linux ??????? shell??
- [fish](https://fishshell.com/) - ?????????????????? shell??
- [xiki](http://xiki.org/) - ? shell ????????????????
- [zsh](http://www.zsh.org/) - ???????? shell ?????????

#### ????????????

?? shell ?????`#!` ?????????°§????????????????????????? Shell ????????`#!` ??????[shebang?????? Hashbang ??](https://zh.wikipedia.org/wiki/Shebang)??

????????????? shell ?ßµ??????????????????

- ??? sh ??????

```bash
#!/bin/sh
```

- ??? bash ??????

```bash
#!/bin/bash
```

> **???**
>
> ??????????????????????????????????????????????????????
>
> ```bash
> #!/usr/bin/env bash
> ```
>
> ?????????????????????? `PATH` ?????????ß”?????????????????ß÷?`bash`???????????ß’??????????????????ß’????????????°§???????????????ß’????????????????????`PATH`?????ß·??????????????????????∑⁄?????Ì‡??????°„∑⁄??`bash`????????????°§??????`PATH`?ßµ????????????∑⁄??????????`#!/bin/bash`??????????????∑⁄??`bash`????ßﬂ?????????`#!/usr/bin/env bash`?????????°„∑⁄??

### 1.4. ??

shell ?ßﬂ?????????????????

#### ??????

> ????????????? shell ???????????????????ß≥?

????????????????????? shell ????????????

```bash
user@host:~$
```

?????????????????? Linux ???????? `ls`??`grep`??`cd`??`mkdir`??`rm` ????

#### ???????

> ????????????? shell ??????????????? shell ?????

???????????shell ????????????ßÿ????????ß≥?

?? shell ???????????????ß÷???????????shell ?????????????????????

?????????????????? shell ???????????ßµ?

```bash
sh /path/to/script.sh
bash /path/to/script.sh
source /path/to/script.sh
./path/to/script.sh
```

??????????ßµ?`script.sh`????????? shell ???????????????ß÷?????????????????`sh`??`bash`?? shell ???????????????????¶ ?????????????`script.sh`??vim??nano??Sublime Text, Atom ??????

???ßµ?`source /path/to/script.sh` ?? `./path/to/script.sh` ??????

????????????????`chmod`??????????????ß÷????????????ßﬂ???????

```bash
chmod +x /path/to/script.sh #??????????????
/path/to/test.sh
```

???????????????????ß“?????????ß⁄??????????ª«

**:keyboard: ????????** [helloworld.sh](https://github.com/dunwu/linux-tutorial/tree/master/codes/shell/demos/helloworld.sh)

```bash
#!/usr/bin/env bash
echo "Hello, world!"
```

??????????ßµ????????????????????????`echo`??????????????????

## 2. ??????

### 2.1. ??????

??????????????`#!` ??????????????????????????????????????Ôì

?? shell ?????`#!` ?????????°§????????????????????????? Shell ????????`#!` ??????[shebang?????? Hashbang ??](https://zh.wikipedia.org/wiki/Shebang)??

`#!` ???????????????????????????????????ßµ??????????????????`sh`, `bash`, `python`, `php`???

```bash
# ??????????????????? shell ??????? bash?????????????
#!/bin/bash
#!/usr/bin/env bash
```

### 2.2. ???

??????????????????????????????????ß’??

shell ???ßµ???????????????? shell ???????????

- ??????? - ?? `#` ?????????¶¬??????
- ??????? - ?? `:<<EOF` ??????? `EOF` ??????

**:keyboard: ????????** [comment-demo.sh](https://github.com/dunwu/linux-tutorial/tree/master/codes/shell/demos/comment-demo.sh)

```bash
#--------------------------------------------
# shell ??????
# author??zp
#--------------------------------------------

# echo '??????????'

########## ???????? ##########

:<<EOF
echo '??????????'
echo '??????????'
echo '??????????'
EOF
```

### 2.3. echo

echo ????????????????

?????????????

```bash
echo "hello, world"
# Output: hello, world
```

??????????????????

```bash
echo "hello, \"zp\""
# Output: hello, "zp"
```

??????????????????

```bash
name=zp
echo "hello, \"${name}\""
# Output: hello, "zp"
```

????????ßŸ??????????

```bash
# ????????ßŸ????????
echo "YES\nNO"
#  Output: YES\nNO

echo -e "YES\nNO" # -e ???????
#  Output:
#  YES
#  NO
```

??????????ßŸ??????????

```bash
echo "YES"
echo "NO"
#  Output:
#  YES
#  NO

echo -e "YES\c" # -e ??????? \c ??????
echo "NO"
#  Output:
#  YESNO
```

?????????????

```bash
echo "test" > test.txt
```

?????ßﬂ??

```bash
echo `pwd`
#  Output:(?????°§??)
```

**:keyboard: ????????** [echo-demo.sh](https://github.com/dunwu/linux-tutorial/tree/master/codes/shell/demos/echo-demo.sh)

### 2.4. printf

printf ??????????????????

????printf ?????? echo ???????????ßŸ????????????ß·????????? `\n`??

**:keyboard: ????????** [printf-demo.sh](https://github.com/dunwu/linux-tutorial/tree/master/codes/shell/demos/printf-demo.sh)

```bash
# ??????
printf '%d %s\n' 1 "abc"
#  Output:1 abc

# ?????
printf "%d %s\n" 1 "abc"
#  Output:1 abc

# ??????
printf %s abcdef
#  Output: abcdef(????????)

# ?????????????????????????????????????????
printf "%s\n" abc def
#  Output:
#  abc
#  def

printf "%s %s %s\n" a b c d e f g h i j
#  Output:
#  a b c
#  d e f
#  g h i
#  j

# ?????ß”???????? %s ?? NULL ???ó®%d ?? 0 ????
printf "%s and %d \n"
#  Output:
#   and 0

# ????????
printf "%-10s %-8s %-4s\n" ???? ??? ????kg
printf "%-10s %-8s %-4.2f\n" ???? ?? 66.1234
printf "%-10s %-8s %-4.2f\n" ??? ?? 48.6543
printf "%-10s %-8s %-4.2f\n" ??? ? 47.9876
#  Output:
#  ????     ???   ????kg
#  ????     ??      66.12
#  ???     ??      48.65
#  ???     ?      47.99
```

#### printf ??????

| ????    | ???                                                                                                                                                                          |
| ------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `\a`    | ????????????? ASCII ?? BEL ???                                                                                                                                            |
| `\b`    | ????                                                                                                                                                                          |
| `\c`    | ?????????????????????¶ ¶Õ?¶¬?????????????%b ??????????????????????????ßπ??????????¶ ?????????????????¶ ¶Õ??????????????¶ ?????????????ß÷?????????????? |
| `\f`    | ?????formfeed??                                                                                                                                                              |
| `\n`    | ????                                                                                                                                                                          |
| `\r`    | ?????Carriage return??                                                                                                                                                       |
| `\t`    | ??????                                                                                                                                                                    |
| `\v`    | ???????                                                                                                                                                                    |
| `\\`    | ???????????ß“?????                                                                                                                                                        |
| `\ddd`  | ??? 1 ?? 3 ¶À??????????????????????????????ßπ                                                                                                                          |
| `\0ddd` | ??? 1 ?? 3 ¶À??????????                                                                                                                                                  |

## 3. ????

??????????????????????????? bash ?ß’?????????

Bash ??????????????bash ?ß÷?????????????????????????????????????????????????????????????????????????????????

### 3.1. ???????????

- ?????????????????????????????????????????????????
- ?ßﬁ????ß·??????????????\_????
- ?????????????
- ??????? bash ???????????? help ?????????????????

### 3.2. ????????

?????????????????`${var}` ?? `$var` ??

??????????????????????????????ßµ???????????????????????????????Ì‡???????????????

```bash
word="hello"
echo ${word}
# Output: hello
```

### 3.3. ???????

??? readonly ????????????????????????????????????????????

```bash
rword="hello"
echo ${rword}
readonly rword
# rword="bye"  # ??????????????????
```

### 3.4. ???????

??? unset ??????????????????????????????????®¢?unset ??????????????????

```bash
dword="hello"  # ????????
echo ${dword}  # ????????
# Output: hello

unset dword    # ???????
echo ${dword}
# Output: ?????
```

### 3.5. ????????

- **???????** - ???????????????????????ßπ????????????????????????????????
- **????????** - ????????????? shell ???????ß÷???????????????????????????????????????????????????? `export` ??????shell ??????????Õ¢????????

???????????????

| ????      | ????                                               |
| --------- | -------------------------------------------------- |
| `$HOME`   | ?????????????                                 |
| `$PATH`   | ?°¬?????????ß“?shell ????ßª???ß”??????? |
| `$PWD`    | ?????????                                       |
| `$RANDOM` | 0 ?? 32767 ????????                              |
| `$UID`    | ??????????????????? ID                        |
| `$PS1`    | ??????????????                                 |
| `$PS2`    | ??????????????                                 |

[????](http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_03_02.html###sect_03_02_04) ?????????? Bash ?????????ß“?

### 3.6. ??????????

**?? ????????** [variable-demo.sh](https://github.com/dunwu/linux-tutorial/tree/master/codes/shell/demos/variable-demo.sh)

## 4. ?????

### 4.1. ????????????

shell ???????????????? `''`?????????????? `????`???????????????

- ??????????
  - ??????????????
  - ???????????????????????????????????ßµ??????????????????????????®¢?
- ?????????
  - ?????????????
  - ???????????????????

?????????????????

### 4.2. ????????

```bash
# ???????????
name1='white'
str1='hello, '${name1}''
str2='hello, ${name1}'
echo ${str1}_${str2}
# Output:
# hello, white_hello, ${name1}

# ???????????
name2="black"
str3="hello, "${name2}""
str4="hello, ${name2}"
echo ${str3}_${str4}
# Output:
# hello, black_hello, black
```

### 4.3. ????????????

```bash
text="12345"
echo ${#text}
# Output:
# 5
```

### 4.4. ??????????

```bash
text="12345"
echo ${text:2:2}
# Output:
# 34
```

??? 3 ????????????? 2 ?????

### 4.5. ???????????

```bash
#!/usr/bin/env bash

text="hello"
echo `expr index "${text}" ll`

# Execute: ./str-demo5.sh
# Output:
# 3
```

???? `ll` ??????? `hello` ??????ß÷????¶À?®¢?

### 4.6. ???????????

**?? ????????** [string-demo.sh](https://github.com/dunwu/linux-tutorial/tree/master/codes/shell/demos/string-demo.sh)

## 5. ????

bash ?????????Óï

?????°¿?? 0 ??????°¿?????????????????????????????????? 0??

### 5.1. ????????

```bash
# ??????????????
nums=([2]=2 [0]=0 [1]=1)
colors=(red yellow "dark blue")
```

### 5.2. ???????????

- **????????????????**

```bash
echo ${nums[1]}
# Output: 1
```

- **?????????????????**

```bash
echo ${colors[*]}
# Output: red yellow dark blue

echo ${colors[@]}
# Output: red yellow dark blue
```

?????????ß‹??????????????????

????????????????????????????????? `printf` ????

```bash
printf "+ %s\n" ${colors[*]}
# Output:
# + red
# + yellow
# + dark
# + blue
```

???`dark`??`blue`???????ßµ??????????????????

```bash
printf "+ %s\n" "${colors[*]}"
# Output:
# + red yellow dark blue
```

???????ß÷????????????? ???? ????????????????????????`${colors[@]}`

```bash
printf "+ %s\n" "${colors[@]}"
# Output:
# + red
# + yellow
# + dark blue
```

?????????`${colors[@]}`???????ß÷?????????????????????????????????ß÷???????????

- **????????????????**

```bash
echo ${nums[@]:0:2}
# Output:
# 0 1
```

????????????ßµ?`${array[@]}` ???????????ÔÖ`:0:2`??????????ß’? 0 ?????????? 2 ??????

### 5.3. ???????¯A??

```bash
echo ${#nums[*]}
# Output:
# 3
```

### 5.4. ??????????????

?????????????????????

```bash
colors=(white "${colors[@]}" green black)
echo ${colors[@]}
# Output:
# white red yellow dark blue green black
```

??????????ßµ?`${colors[@]}` ???????????ÔÖ???????????????????ßµ????????????`colors`????????????????????

### 5.5. ??????????????

??`unset`????????????????????????

```bash
unset nums[0]
echo ${nums[@]}
# Output:
# 1 2
```

### 5.6. ??????????

**:keyboard: ????????** [array-demo.sh](https://github.com/dunwu/linux-tutorial/tree/master/codes/shell/demos/array-demo.sh)

## 6. ?????

### 6.1. ?????????

?°¿??ß‘????????????????????????? x ? 10?????? y ? 20??

| ????? | ???                                          | ????                           |
| ------ | --------------------------------------------- | ------------------------------ |
| +      | ???                                          | `expr $x + $y` ???? 30??     |
| -      | ????                                          | `expr $x - $y` ???? -10??    |
| \*     | ???                                          | `expr $x * $y` ???? 200??    |
| /      | ????                                          | `expr $y / $x` ???? 2??      |
| %      | ???                                          | `expr $y % $x` ???? 0??      |
| =      | ???                                          | `x=$y` ??????? y ??????? x?? |
| ==     | ????????????????????????? true??     | `[ $x == $y ]` ???? false??    |
| !=     | ????????????????????????????? true?? | `[ $x != $y ]` ???? true??     |

**???**???????????????????????????ß·??????: `[$x==$y]` ???????????ß’?? `[ $x == $y ]`??

**:keyboard: ????????** [operator-demo.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/operator/operator-demo.sh)

```bash
x=10
y=20

echo "x=${x}, y=${y}"

val=`expr ${x} + ${y}`
echo "${x} + ${y} = $val"

val=`expr ${x} - ${y}`
echo "${x} - ${y} = $val"

val=`expr ${x} \* ${y}`
echo "${x} * ${y} = $val"

val=`expr ${y} / ${x}`
echo "${y} / ${x} = $val"

val=`expr ${y} % ${x}`
echo "${y} % ${x} = $val"

if [[ ${x} == ${y} ]]
then
  echo "${x} = ${y}"
fi
if [[ ${x} != ${y} ]]
then
  echo "${x} != ${y}"
fi

#  Execute: ./operator-demo.sh
#  Output:
#  x=10, y=20
#  10 + 20 = 30
#  10 - 20 = -10
#  10 * 20 = 200
#  20 / 10 = 2
#  20 % 10 = 0
#  10 != 20
```

### 6.2. ????????

????????????????????????????????????????????????

?°¿??ß‘??????????????????????? x ? 10?????? y ? 20??

| ????? | ???                                                  | ????                         |
| ------ | ----------------------------------------------------- | ---------------------------- |
| `-eq`  | ?????????????????????? true??                   | `[ $a -eq $b ]`???? false??  |
| `-ne`  | ???????????????????????? true??                 | `[ $a -ne $b ]` ???? true??  |
| `-gt`  | ????????????????????????????? true??     | `[ $a -gt $b ]` ???? false?? |
| `-lt`  | ????????????ß≥???????????????? true??     | `[ $a -lt $b ]` ???? true??  |
| `-ge`  | ???????????????????????????????? true?? | `[ $a -ge $b ]` ???? false?? |
| `-le`  | ????????????ß≥??????????????????? true?? | `[ $a -le $b ]`???? true??   |

**:keyboard: ????????** [operator-demo2.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/operator/operator-demo2.sh)

```bash
x=10
y=20

echo "x=${x}, y=${y}"

if [[ ${x} -eq ${y} ]]; then
   echo "${x} -eq ${y} : x ???? y"
else
   echo "${x} -eq ${y}: x ?????? y"
fi

if [[ ${x} -ne ${y} ]]; then
   echo "${x} -ne ${y}: x ?????? y"
else
   echo "${x} -ne ${y}: x ???? y"
fi

if [[ ${x} -gt ${y} ]]; then
   echo "${x} -gt ${y}: x ???? y"
else
   echo "${x} -gt ${y}: x ?????? y"
fi

if [[ ${x} -lt ${y} ]]; then
   echo "${x} -lt ${y}: x ß≥?? y"
else
   echo "${x} -lt ${y}: x ??ß≥?? y"
fi

if [[ ${x} -ge ${y} ]]; then
   echo "${x} -ge ${y}: x ???????? y"
else
   echo "${x} -ge ${y}: x ß≥?? y"
fi

if [[ ${x} -le ${y} ]]; then
   echo "${x} -le ${y}: x ß≥?????? y"
else
   echo "${x} -le ${y}: x ???? y"
fi

#  Execute: ./operator-demo2.sh
#  Output:
#  x=10, y=20
#  10 -eq 20: x ?????? y
#  10 -ne 20: x ?????? y
#  10 -gt 20: x ?????? y
#  10 -lt 20: x ß≥?? y
#  10 -ge 20: x ß≥?? y
#  10 -le 20: x ß≥?????? y
```

### 6.3. ?????????

?°¿??ß‘???????????????????????? x ? 10?????? y ? 20??

| ????? | ???                                                | ????                                       |
| ------ | --------------------------------------------------- | ------------------------------------------ |
| `!`    | ??????????? true ??? false??????? true?? | `[ ! false ]` ???? true??                  |
| `-o`   | ???????????????? true ??? true??           | `[ $a -lt 20 -o $b -gt 100 ]` ???? true??  |
| `-a`   | ????????????????? true ????? true??           | `[ $a -lt 20 -a $b -gt 100 ]` ???? false?? |

**:keyboard: ????????** [operator-demo3.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/operator/operator-demo3.sh)

```bash
x=10
y=20

echo "x=${x}, y=${y}"

if [[ ${x} != ${y} ]]; then
   echo "${x} != ${y} : x ?????? y"
else
   echo "${x} != ${y}: x ???? y"
fi

if [[ ${x} -lt 100 && ${y} -gt 15 ]]; then
   echo "${x} ß≥?? 100 ?? ${y} ???? 15 : ???? true"
else
   echo "${x} ß≥?? 100 ?? ${y} ???? 15 : ???? false"
fi

if [[ ${x} -lt 100 || ${y} -gt 100 ]]; then
   echo "${x} ß≥?? 100 ?? ${y} ???? 100 : ???? true"
else
   echo "${x} ß≥?? 100 ?? ${y} ???? 100 : ???? false"
fi

if [[ ${x} -lt 5 || ${y} -gt 100 ]]; then
   echo "${x} ß≥?? 5 ?? ${y} ???? 100 : ???? true"
else
   echo "${x} ß≥?? 5 ?? ${y} ???? 100 : ???? false"
fi

#  Execute: ./operator-demo3.sh
#  Output:
#  x=10, y=20
#  10 != 20 : x ?????? y
#  10 ß≥?? 100 ?? 20 ???? 15 : ???? true
#  10 ß≥?? 100 ?? 20 ???? 100 : ???? true
#  10 ß≥?? 5 ?? 20 ???? 100 : ???? false
```

### 6.4. ????????

??????? Shell ??????????????????? x ? 10?????? y ? 20:

| ????? | ???       | ????                                            |
| ------ | ---------- | ----------------------------------------------- |
| `&&`   | ????? AND | `[[ ${x} -lt 100 && ${y} -gt 100 ]]` ???? false |
| `||`   | ????? OR  | `[[ ${x} -lt 100 || ${y} -gt 100 ]]` ???? true  |

**:keyboard: ????????** [operator-demo4.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/operator/operator-demo4.sh)

```bash
x=10
y=20

echo "x=${x}, y=${y}"

if [[ ${x} -lt 100 && ${y} -gt 100 ]]
then
   echo "${x} -lt 100 && ${y} -gt 100 ???? true"
else
   echo "${x} -lt 100 && ${y} -gt 100 ???? false"
fi

if [[ ${x} -lt 100 || ${y} -gt 100 ]]
then
   echo "${x} -lt 100 || ${y} -gt 100 ???? true"
else
   echo "${x} -lt 100 || ${y} -gt 100 ???? false"
fi

#  Execute: ./operator-demo4.sh
#  Output:
#  x=10, y=20
#  10 -lt 100 && 20 -gt 100 ???? false
#  10 -lt 100 || 20 -gt 100 ???? true
```

### 6.5. ??????????

?°¿??ß‘?????????????????????????? a ? "abc"?????? b ? "efg"??

| ????? | ???                                       | ????                       |
| ------ | ------------------------------------------ | -------------------------- |
| `=`    | ????????????????????????? true??    | `[ $a = $b ]` ???? false?? |
| `!=`   | ??????????????????????????? true??  | `[ $a != $b ]` ???? true?? |
| `-z`   | ???????????????? 0??? 0 ???? true??   | `[ -z $a ]` ???? false??   |
| `-n`   | ???????????????? 0????? 0 ???? true?? | `[ -n $a ]` ???? true??    |
| `str`  | ??????????????????????? true??      | `[ $a ]` ???? true??       |

**:keyboard: ????????** [operator-demo5.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/operator/operator-demo5.sh)

```bash
x="abc"
y="xyz"


echo "x=${x}, y=${y}"

if [[ ${x} = ${y} ]]; then
   echo "${x} = ${y} : x ???? y"
else
   echo "${x} = ${y}: x ?????? y"
fi

if [[ ${x} != ${y} ]]; then
   echo "${x} != ${y} : x ?????? y"
else
   echo "${x} != ${y}: x ???? y"
fi

if [[ -z ${x} ]]; then
   echo "-z ${x} : ?????????? 0"
else
   echo "-z ${x} : ??????????? 0"
fi

if [[ -n "${x}" ]]; then
   echo "-n ${x} : ??????????? 0"
else
   echo "-n ${x} : ?????????? 0"
fi

if [[ ${x} ]]; then
   echo "${x} : ??????????"
else
   echo "${x} : ????????"
fi

#  Execute: ./operator-demo5.sh
#  Output:
#  x=abc, y=xyz
#  abc = xyz: x ?????? y
#  abc != xyz : x ?????? y
#  -z abc : ??????????? 0
#  -n abc : ??????????? 0
#  abc : ??????????
```

### 6.6. ????????????

?????????????????? Unix ?????????????

???????????????

| ??????  | ???                                                                        | ????                        |
| ------- | --------------------------------------------------------------------------- | --------------------------- |
| -b file | ?????????????ıÙ?????????????? true??                             | `[ -b $file ]` ???? false?? |
| -c file | ???????????????ıÙ?????????????? true??                           | `[ -c $file ]` ???? false?? |
| -d file | ???????????????????????? true??                                   | `[ -d $file ]` ???? false?? |
| -f file | ??????????????????????????????????ıÙ???????????????? true?? | `[ -f $file ]` ???? true??  |
| -g file | ??????????????? SGID ¶À??????????? true??                           | `[ -g $file ]` ???? false?? |
| -k file | ??????????????????¶À(Sticky Bit)??????????? true??                 | `[ -k $file ]`???? false??  |
| -p file | ????????????????????????????? true??                               | `[ -p $file ]` ???? false?? |
| -u file | ??????????????? SUID ¶À??????????? true??                           | `[ -u $file ]` ???? false?? |
| -r file | ?????????????????????? true??                                     | `[ -r $file ]` ???? true??  |
| -w file | ??????????ß’??????????? true??                                     | `[ -w $file ]` ???? true??  |
| -x file | ????????????ßµ?????????? true??                                   | `[ -x $file ]` ???? true??  |
| -s file | ??????????????????ß≥?????? 0???????????? true??                   | `[ -s $file ]` ???? true??  |
| -e file | ???????????????????????????????? true??                         | `[ -e $file ]` ???? true??  |

**:keyboard: ????????** [operator-demo6.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/operator/operator-demo6.sh)

```bash
file="/etc/hosts"

if [[ -r ${file} ]]; then
   echo "${file} ??????"
else
   echo "${file} ????????"
fi
if [[ -w ${file} ]]; then
   echo "${file} ?????ß’"
else
   echo "${file} ???????ß’"
fi
if [[ -x ${file} ]]; then
   echo "${file} ????????"
else
   echo "${file} ??????????"
fi
if [[ -f ${file} ]]; then
   echo "${file} ??????????"
else
   echo "${file} ???????????"
fi
if [[ -d ${file} ]]; then
   echo "${file} ????????"
else
   echo "${file} ??????????"
fi
if [[ -s ${file} ]]; then
   echo "${file} ????????"
else
   echo "${file} ??????"
fi
if [[ -e ${file} ]]; then
   echo "${file} ???????"
else
   echo "${file} ?????????"
fi

#  Execute: ./operator-demo6.sh
#  Output:(?????????????????????????????)
#  /etc/hosts ??????
#  /etc/hosts ?????ß’
#  /etc/hosts ??????????
#  /etc/hosts ??????????
#  /etc/hosts ??????????
#  /etc/hosts ????????
#  /etc/hosts ???????
```

## 7. ???????

### 7.1. ???????

??????????????????????Bash ?ß÷????????????????????????????????ß≥????????????????`[[ ]]`????????

??`[[ ]]`??`sh`????`[ ]`??????????????????? **???????** ?? **???**????ßª??????????????????????????????????????ß€?[bash ?ß÷????????????](http://serverfault.com/a/52050)????

???????????????????????`if`??`case`??

#### `if`

??1??`if` ???

`if`??????????????????????????????????????ó®???`then`??`fi`??????????ß≥?`fi`????????????????????

```bash
# ß’?????
if [[ 1 -eq 1 ]]; then echo "1 -eq 1 result is: true"; fi
# Output: 1 -eq 1 result is: true

# ß’?????
if [[ "abc" -eq "abc" ]]
then
  echo ""abc" -eq "abc" result is: true"
fi
# Output: abc -eq abc result is: true
```

??2??`if else` ???

???????????????`if..else`??????ª«

```bash
if [[ 2 -ne 1 ]]; then
  echo "true"
else
  echo "false"
fi
# Output: true
```

??3??`if elif else` ???

??ßª???`if..else`?????????????????????`if..elif..else`???????????????

```bash
x=10
y=20
if [[ ${x} > ${y} ]]; then
   echo "${x} > ${y}"
elif [[ ${x} < ${y} ]]; then
   echo "${x} < ${y}"
else
   echo "${x} = ${y}"
fi
# Output: 10 < 20
```

**:keyboard: ????????** [if-demo.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/statement/if-demo.sh)

#### `case`

????????????????????????????????????????`case`???????`if`?????®¢????`case`???????????????ßÿ????????????????????

**:keyboard: ????????** [case-demo.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/statement/case-demo.sh)

```bash
exec
case ${oper} in
  "+")
    val=`expr ${x} + ${y}`
    echo "${x} + ${y} = ${val}"
  ;;
  "-")
    val=`expr ${x} - ${y}`
    echo "${x} - ${y} = ${val}"
  ;;
  "*")
    val=`expr ${x} \* ${y}`
    echo "${x} * ${y} = ${val}"
  ;;
  "/")
    val=`expr ${x} / ${y}`
    echo "${x} / ${y} = ${val}"
  ;;
  *)
    echo "Unknown oper!"
  ;;
esac
```

???????????????????????????`|`?????????????`)`????????????????ß≥???????????????????????????ß≥?`*`?????¶ ¶¬???????????????????????????????`;;`?????

### 7.2. ??????

????????????µµ??????????????????????bash ?ß÷?????????????????????????????ß÷????Óï

Bash ?????????????`for`??`while`??`until`??`select`??

#### `for`???

`for`?????? C ?????ß÷???°¬?????????????????

```bash
for arg in elem1 elem2 ... elemN
do
  ### ???
done
```

??????????????ßµ?`arg`???¶¡???????`elem1`??`elemN`????ßª?????????????????[?????????](https://github.com/denysdovhan/bash-handbook/blob/master/translations/zh-CN/README.md#%E5%A4%A7%E6%8B%AC%E5%8F%B7%E6%89%A9%E5%B1%95)??

???????????????`for`???ß’????ßµ????????`do`??????????????????????????

```bash
for i in {1..5}; do echo $i; done
```

???ßµ?????????`for..in..do`????????ß÷????????????????? C ???????????`for`?????ª«

```bash
for (( i = 0; i < 10; i++ )); do
  echo $i
done
```

?????????????????????????????????????`for`??????????????????????????????ß÷?`.bash`????????`script`??????ßµ????????????????????????????????ß’??

```bash
DIR=/home/zp
for FILE in ${DIR}/*.sh; do
  mv "$FILE" "${DIR}/scripts"
done
# ?? /home/zp ???????? sh ????????? /home/zp/scripts
```

**:keyboard: ????????** [for-demo.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/statement/for-demo.sh)

#### `while`???

`while`????????????????????????? _??_?????????????˛ü????????????`if..then`??????[???](https://github.com/denysdovhan/bash-handbook/blob/master/translations/zh-CN/README.md#%E5%9F%BA%E5%85%83%E5%92%8C%E7%BB%84%E5%90%88%E8%A1%A8%E8%BE%BE%E5%BC%8F)?????????????`while`???????????????????

```bash
while [[ condition ]]
do
  ### ???
done
```

??`for`????????????????`do`???????????ß’????ßµ???????????`do`???????????

????????????????

```bash
### 0??9?????????????
x=0
while [[ ${x} -lt 10 ]]; do
  echo $((x * x))
  x=$((x + 1))
done
#  Output:
#  0
#  1
#  4
#  9
#  16
#  25
#  36
#  49
#  64
#  81
```

**:keyboard: ????????** [while-demo.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/statement/while-demo.sh)

#### `until`???

`until`?????`while`???????????????`while`?????????????????????????????????????????? _??_ ????????????

```bash
x=0
until [[ ${x} -ge 5 ]]; do
  echo ${x}
  x=`expr ${x} + 1`
done
#  Output:
#  0
#  1
#  2
#  3
#  4
```

**:keyboard: ????????** [until-demo.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/statement/until-demo.sh)

#### `select`???

`select`?????????????????????????????????????`for`???????

```bash
select answer in elem1 elem2 ... elemN
do
  ### ???
done
```

`select`????`elem1..elemN`???????????ß‹?????????????????????????????????`$?`??`PS3`???????????????????????õ‘`answer`?ß≥????`answer`???????`1..N`????????????`???`????ßµ???????????????¶≈??? ???? ????????????????????????`break`???

????????????????????????

```bash
#!/usr/bin/env bash

PS3="Choose the package manager: "
select ITEM in bower npm gem pip
do
echo -n "Enter the package name: " && read PACKAGE
case ${ITEM} in
  bower) bower install ${PACKAGE} ;;
  npm) npm install ${PACKAGE} ;;
  gem) gem install ${PACKAGE} ;;
  pip) pip install ${PACKAGE} ;;
esac
break # ???????????
done
```

?????????????????????????????????????????????????????????????ß—????????

?????????????????????????

```bash
$ ./my_script
1) bower
2) npm
3) gem
4) pip
Choose the package manager: 2
Enter the package name: gitbook-cli
```

**:keyboard: ????????** [select-demo.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/statement/select-demo.sh)

#### `break` ?? `continue`

????????????????????????????????ßµ???????? shell ??`break`??`continue`???????????????????¶ ????????®¢?

> `break`??????????????????????
>
> `continue`?????????????¶≈?????

**:keyboard: ????????** [break-demo.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/statement/break-demo.sh)

```bash
# ???? 10 ?????????????? 2 ?? 3 ????????
i=1
while [[ ${i} -lt 10 ]]; do
  if [[ $((i % 3)) -eq 0 ]] && [[ $((i % 2)) -eq 0 ]]; then
    echo ${i}
    break;
  fi
  i=`expr ${i} + 1`
done
# Output: 6
```

**:keyboard: ????????** [continue-demo.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/statement/continue-demo.sh)

```bash
# ???10?????????
for (( i = 0; i < 10; i ++ )); do
  if [[ $((i % 2)) -eq 0 ]]; then
    continue;
  fi
  echo ${i}
done
#  Output:
#  1
#  3
#  5
#  7
#  9
```

## 8. ????

bash ???????????????

```bash
[ function ] funname [()] {
    action;
    [return int;]
}
```

> :bulb: ?????
>
> 1. ???????????`function` ???????ß·????
> 2. ????????? - return ?????????????????????????????????0-255??????????? return ???shell ????????????????????ßﬂ??????????????????
> 3. ??????????????®≤???????? `$?` ????®¢?
> 4. ???ß‹??????????????â^????¶∆?????????????????????????? shell ????????¶«???????????????®¢????®≤?????????Åâ???????®¿?

**:keyboard: ????????** [function-demo.sh](https://github.com/dunwu/linux-tutorial/tree/master/codes/shell/demos//function/function-demo.sh)

```bash
#!/usr/bin/env bash

calc(){
  PS3="choose the oper: "
  select oper in + - \* / # ??????????????
  do
  echo -n "enter first num: " && read x # ??????????
  echo -n "enter second num: " && read y # ??????????
  exec
  case ${oper} in
    "+")
      return $((${x} + ${y}))
    ;;
    "-")
      return $((${x} - ${y}))
    ;;
    "*")
      return $((${x} * ${y}))
    ;;
    "/")
      return $((${x} / ${y}))
    ;;
    *)
      echo "${oper} is not support!"
      return 0
    ;;
  esac
  break
  done
}
calc
echo "the result is: $?" # $? ??? calc ?????????
```

??ßﬂ????

```bash
$ ./function-demo.sh
1) +
2) -
3) *
4) /
choose the oper: 3
enter first num: 10
enter second num: 10
the result is: 100
```

### 8.1. ¶À?®∞???

**¶À?®∞???**??????????????????????????????????????

¶À?®∞?????????

| ????           | ????                           |
| -------------- | ------------------------------ |
| `$0`           | ???????                       |
| `$1 ?? $9`      | ?? 1 ?????? 9 ???????ß“?       |
| `${10} ?? ${N}` | ?? 10 ???? N ???????ß“?        |
| `$*` or `$@`   | ????`$0`???????¶À?®∞???       |
| `$#`           | ??????`$0`?????¶À?®∞???????? |
| `$FUNCNAME`    | ????????????????????????   |

**:keyboard: ????????** [function-demo2.sh](https://github.com/dunwu/linux-tutorial/tree/master/codes/shell/demos//function/function-demo2.sh)

```bash
#!/usr/bin/env bash

x=0
if [[ -n $1 ]]; then
  echo "????????????$1"
  x=$1
else
  echo "????????????"
fi

y=0
if [[ -n $2 ]]; then
  echo "????????????$2"
  y=$2
else
  echo "????????????"
fi

paramsFunction(){
  echo "???????????¶≤?$1"
  echo "???????????¶≤?$2"
}
paramsFunction ${x} ${y}
```

??ßﬂ????

```bash
$ ./function-demo2.sh
????????????
????????????
???????????¶≤?0
???????????¶≤?0

$ ./function-demo2.sh 10 20
????????????10
????????????20
???????????¶≤?10
???????????¶≤?20
```

??? `./variable-demo4.sh hello world` ?????????????? `$1`??`$2` ... ????? 1 ?????????? 2 ????????????

### 8.2. ???????????

???????ßﬁ???????????????????????

| ???????? | ???                                             |
| -------- | ------------------------------------------------ |
| `$#`     | ???????????                                     |
| `$*`     | ???????ß”???                                     |
| `$$`     | ??????ß÷??????? ID ??                         |
| `$!`     | ??????ß÷???????????? ID ??                   |
| `$@`     | ???????ß”???                                     |
| `$-`     | ???? Shell ??????????? set ??????????? |
| `$?`     | ?????????                                       |

**:keyboard: ????????** [function-demo3.sh](https://github.com/dunwu/linux-tutorial/tree/master/codes/shell/demos//function/function-demo3.sh)

```bash
runner() {
  return 0
}

name=zp
paramsFunction(){
  echo "???????????¶≤?$1"
  echo "???????????¶≤?$2"
  echo "???????????????????$#"
  echo "???ß”?????"
  printf "+ %s\n" "$*"
  echo "??????ß÷??????? ID ???$$"
  echo "??????ß÷???????????? ID ???$!"
  echo "???ß”?????"
  printf "+ %s\n" "$@"
  echo "Shell ?????????$-"
  runner
  echo "runner ????????????$?"
}
paramsFunction 1 "abc" "hello, \"zp\""
#  Output:
#  ???????????¶≤?1
#  ???????????¶≤?abc
#  ???????????????????3
#  ???ß”?????
#  + 1 abc hello, "zp"
#  ??????ß÷??????? ID ???26400
#  ??????ß÷???????????? ID ???
#  ???ß”?????
#  + 1
#  + abc
#  + hello, "zp"
#  Shell ?????????hB
#  runner ????????????0
```

## 9. Shell ???

_???_ ??????????????????????? _????tokens??_ ?????????????????????????????????????????????????????ßﬂ????????

???????????????[???? shell ???????????](https://www.gnu.org/software/bash/manual/bash.html###Shell-Expansions)??

#### ?????????

????????????????????????????????????? _????????_ ???????????????

```bash
echo beg{i,a,u}n ### begin began begun
```

??????????????????????????????????????????

```bash
echo {0..5} ### 0 1 2 3 4 5
echo {00..8..2} ### 00 02 04 06 08
```

#### ???????

???????????????????????????????????????????????????????????????ß≥??????????``??`$()`??¶∂????????????????ß≥?????????

```bash
now=`date +%T`
### or
now=$(date +%T)

echo $now ### 19:08:26
```

#### ???????

?? bash ?ßµ?????????????????????????????????????`$(( ))`?ß≥???????????????

```bash
result=$(( ((10 + 5*3) - 7) / 2 ))
echo $result ### 9
```

???????????ßµ??????????????`$`????

```bash
x=4
y=7
echo $(( x + y ))     ### 11
echo $(( ++x + y++ )) ### 12
echo $(( x + y ))     ### 13
```

#### ????????????

????????????????ß‹??????????????????ßµ????????????????????????????????????????????????????

```bash
echo "Your home: $HOME" ### Your home: /Users/<username>
echo 'Your home: $HOME' ### Your home: $HOME
```

???????????????????????????????????????ß÷????????????????????????????????`echo`??????????????

```bash
INPUT="A string  with   strange    whitespace."
echo $INPUT   ### A string with strange whitespace.
echo "$INPUT" ### A string  with   strange    whitespace.
```

????????`echo`??????? 5 ??????????? ???? `$INPUT` ??????????????`echo`?????????????????????????????????`echo`?????????????????????\$INPUT ????????????ß÷????

???????????????????

```bash
FILE="Favorite Things.txt"
cat $FILE   ### ??????????????: `Favorite` ?? `Things.txt`
cat "$FILE" ### ?????????: `Favorite Things.txt`
```

??????????????????? FILE ????????`Favorite-Things.txt`????????????????????????????????????????????¶À?®∞?????????????????????`find`, `cat`, ?????????????????? _????_ ?????????????????????????????

## 10. ?????????

Bash ?ß‹?????????????????????ßø????????????????????????????????????????????????????????????????????????????ßª?????????????????

??????????????????????????????????ß‘???????

??????????ßª??????????????????????????

### 10.1. ?????????

Bash ??????????????????ß›? **?????** ????????????????ßª???????????????????????ß≥?

?????????????????

| ???? | ??????   | ????         |
| ---- | -------- | ------------ |
| `0`  | `stdin`  | ???????     |
| `1`  | `stdout` | ??????     |
| `2`  | `stderr` | ?????????? |

### 10.2. ?????

??????????????????????????????????????????????????????ßª???????????????????????????

| Operator | Description                                                   |
| -------- | ------------------------------------------------------------- |
| `>`      | ????????                                                    |
| `&>`     | ????????????????                                          |
| `&>>`    | ?????????????????????????                              |
| `<`      | ?????????                                                    |
| `<<`     | [Here ???](http://tldp.org/LDP/abs/html/here-docs.html) ?? |
| `<<<`    | [Here ?????](http://www.tldp.org/LDP/abs/html/x17837.html)   |

???????ßª??????????????

```bash
### ls????????ß’??list.txt??
ls -l > list.txt

### ??????????list.txt??
ls -a >> list.txt

### ???ß÷?????????ß’??errors.txt??
grep da * 2> errors.txt

### ??errors.txt?ßÿ??????
less < errors.txt
```

### 10.3. `/dev/null` ???

?????????????????????????????????????????????????????????? /dev/null??

```bash
$ command > /dev/null
```

/dev/null ???????????????ß’????????????????????????????????????????????????????????? /dev/null ??????????????????????????????????"??????"??ßπ????

?????????? stdout ?? stderr??????????ß’??

```bash
$ command > /dev/null 2>&1
```

## 11. Debug

shell ???????? debug ?????????

???????? debug ???????????????????? shebang ????????????????

```
#!/bin/bash options
```

options ???ßª?????? shell ???????˛ü?°¿????ßª???????????????

| Short | Name        | Description                                                |
| ----- | ----------- | ---------------------------------------------------------- |
| `-f`  | noglob      | ?????????????globbing??                                 |
| `-i`  | interactive | ?????? _????_ ??????                                   |
| `-n`  | noexec      | ?????????????ßµ?????ÔÇ                             |
| `-t`  | ??           | ?????????????????                                     |
| `-v`  | verbose     | ?????????????????`stderr`?????????                     |
| `-x`  | xtrace      | ?????????????????`stderr`?????????????????????????? |

??????????????????????????`-x`???ª«

```bash
#!/bin/bash -x

for (( i = 0; i < 3; i++ )); do
  echo $i
done
```

?????`stdout`???????????????ßª??????????????

```bash
$ ./my_script
+ (( i = 0 ))
+ (( i < 3 ))
+ echo 0
0
+ (( i++  ))
+ (( i < 3 ))
+ echo 1
1
+ (( i++  ))
+ (( i < 3 ))
+ echo 2
2
+ (( i++  ))
+ (( i < 3 ))
```

??????????? debug ????????????????????????`set`?????????????????????????????˛ü???`-`???????`+`???????

**:keyboard: ????????** [debug-demo.sh](https://github.com/dunwu/linux-tutorial/blob/master/codes/shell/demos/debug-demo.sh)

```bash
# ???? debug
set -x
for (( i = 0; i < 3; i++ )); do
  printf ${i}
done
# ??? debug
set +x
#  Output:
#  + (( i = 0 ))
#  + (( i < 3 ))
#  + printf 0
#  0+ (( i++  ))
#  + (( i < 3 ))
#  + printf 1
#  1+ (( i++  ))
#  + (( i < 3 ))
#  + printf 2
#  2+ (( i++  ))
#  + (( i < 3 ))
#  + set +x

for i in {1..5}; do printf ${i}; done
printf "\n"
#  Output: 12345
```

## 12. ????????

> :notebook: ??????˘r??????[blog](https://github.com/dunwu/blog)??

- [awesome-shell](https://github.com/alebcay/awesome-shell)??shell ????ß“?
- [awesome-bash](https://github.com/awesome-lists/awesome-bash)??bash ????ß“?
- [bash-handbook](https://github.com/denysdovhan/bash-handbook)
- [bash-guide](https://github.com/vuuihc/bash-guide) ??bash ?????°¬????
- [bash-it](https://github.com/Bash-it/bash-it)?????????????????????? shell ????????????????????????????
- [dotfiles.github.io](http://dotfiles.github.io/)???????? bash ?????? shell ????? dotfiles ??????? shell ????????
- [Runoob Shell ???](http://www.runoob.com/linux/linux-shell.html)
- [shellcheck](https://github.com/koalaman/shellcheck) ?????? shell ???????????????????? bash??sh??zsh ?? lint??

???Stack Overflow ?? [bash ?????](https://stackoverflow.com/questions/tagged/bash)?ß‹??????????????????????????????????????????????
