# Docker ????

????????????§Ö?????????????????????????????????????????????????????????§Ö?????????????????????????????????????????????????????¨¢?

<!-- TOC depthFrom:2 depthTo:3 -->

- [????????](#????????)
    - [?????????](#?????????)
    - [?????????????](#?????????????)
- [???????](#???????)
- [???????](#???????)
- [????????](#????????)
    - [`attach` ????](#attach-????)
    - [`exec` ????](#exec-????)
- [?????????????](#?????????????)
    - [????????](#????????)
    - [????????????](#????????????)
- [???????](#???????)
- [???????§Õ??????????????](#???????§Õ??????????????)

<!-- /TOC -->

## ????????

??????????????????????????????????????????????????????????????????`stopped`??????????????????

??? Docker ???????????????????????????????????????????????????

### ?????????

??????????????? `docker run`??

???íà??????????????? ??Hello World????????????????

```bash
$ docker run ubuntu:14.04 /bin/echo 'Hello world'
Hello world
```

?????????????? `/bin/echo 'hello world'` ?????§à??????¦Ê?????

?????????????????? bash ??????????????§ß?????

```bash
$ docker run -t -i ubuntu:14.04 /bin/bash
root@af8bae53bdd3:/#
```

???§µ?`-t` ????? Docker ???????¦Á????pseudo-tty?????????????????????? `-i` ????????????????????

?????????????????????????????????????????????

```bash
root@af8bae53bdd3:/# pwd
/
root@af8bae53bdd3:/# ls
bin boot dev etc home lib lib64 media mnt opt proc root run sbin srv sys tmp usr var
```

?????? `docker run` ?????????????Docker ???????§Ö?????????????

- ??÷‚?????????????????????????§Ó??????
- ?????????????????????
- ???????????????????????????????????????§Õ??
- ???????????????????????????????????????????
- ????????????? ip ?????????
- ?????????????¨®???
- ????????????????

### ?????????????

???????? `docker container start` ??????????????????????????????§³?

??????????????§Ö???¨®???????????????????¨®????????????????????????????????????????????¦Á????????? `ps` ?? `top` ?????????????

```bash
root@ba267838cc1b:/# ps
  PID TTY          TIME CMD
    1 ?        00:00:00 bash
   11 ?        00:00:00 ps
```

??????????§ß???????????? bash ??¨¢??????????? Docker ??????????????????????????????????????

## ???????

????????????? Docker ???????§Ø?????????????????????????????????????????????????? `-d` ??????????

??????????????????????

???????? `-d` ??????????????

```bash
$ docker run ubuntu:18.04 /bin/sh -c "while true; do echo hello world; sleep 1; done"
hello world
hello world
hello world
hello world
```

?????????????? (STDOUT) ???????????????

???????? `-d` ??????????????

```bash
$ docker run -d ubuntu:18.04 /bin/sh -c "while true; do echo hello world; sleep 1; done"
77b2dc01fe0f3f1265df143181e7b9af5e05279a884f4776ee75350ea9d8017a
```

????????????????§Ó????????????? (STDOUT) ???????????????(???????????? `docker logs` ??)??

**???** ?????????????§µ???? `docker run` ??????????§Û???? `-d` ????????

??? `-d` ????????????????¦·??? id?????????? `docker container ls` ?????????????????

```
$ docker container ls
CONTAINER ID  IMAGE         COMMAND               CREATED        STATUS       PORTS NAMES
77b2dc01fe0f  ubuntu:18.04  /bin/sh -c 'while tr  2 minutes ago  Up 1 minute        agitated_wright
```

????????????????????????? `docker container logs` ???þŸ

```bash
$ docker container logs [container ID or NAMES]
hello world
hello world
hello world
. . .
```

## ???????

??????? `docker container stop` ?????????????§Ö???????

?????? Docker ?????????????????????????????????

????????????????????????????????????????? `exit` ????? `Ctrl+d` ????????????????????????????????

????????????????? `docker container ls -a` ????????????

```bash
docker container ls -a
CONTAINER ID        IMAGE                    COMMAND                CREATED             STATUS                          PORTS               NAMES
ba267838cc1b        ubuntu:14.04             "/bin/bash"            30 minutes ago      Exited (0) About a minute ago                       trusting_newton
98e5efa7d997        training/webapp:latest   "python app.py"        About an hour ago   Exited (0) 34 minutes ago                           backstabbing_pike
```

???????????????????????? `docker container start` ????????????????

????`docker container restart` ?????????????????????????????????????????

## ????????

????? `-d` ?????????????????????????

?§»?????????????????§Ó???????????? `docker attach` ????? `docker exec` ????????????? `docker exec` ???????????????????

### `attach` ????

`docker attach` ?? Docker ????????þŸ?????????????????þŸ

```bash
$ docker run -dit ubuntu
243c32535da7d142fb0e6df616a3c3ada0b8ab417937c853a9e1c251f499f550

$ docker container ls
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
243c32535da7        ubuntu:latest       "/bin/bash"         18 seconds ago      Up 17 seconds                           nostalgic_hypatia

$ docker attach 243c
root@243c32535da7:/#
```

_???_ ???????? stdin ?? exit????????????????

### `exec` ????

#### -i -t ????

`docker exec` ?????????????????????????? `-i` `-t` ??????

??? `-i` ?????????????§Ù???¦Á???????????????????? Linux ???????????????????§ß?????????????

?? `-i` `-t` ?????????????????????????????? Linux ???????????

```bash
$ docker run -dit ubuntu
69d137adef7a8a689cbcb059e94da5489d3cddd240ff675c640c8d96e84fe1f6

$ docker container ls
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
69d137adef7a        ubuntu:latest       "/bin/bash"         18 seconds ago      Up 17 seconds                           zealous_swirles

$ docker exec -i 69d1 bash
ls
bin
boot
dev
...

$ docker exec -it 69d1 bash
root@69d137adef7a:/#
```

???????? stdin ?? exit??????????????????????????????????? `docker exec` ?????

??????????????? `docker exec --help` ????

## ?????????????

### ????????

???????????????????????????? `docker export` ???þŸ

```bash
$ docker container ls -a
CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS                    PORTS               NAMES
7691a814370e        ubuntu:14.04        "/bin/bash"         36 hours ago        Exited (0) 21 hours ago                       test
$ docker export 7691a814370e > ubuntu.tar
```

????????????????????????????

### ????????????

??????? `docker import` ?????????????????????????????

```bash
$ cat ubuntu.tar | docker import - test/ubuntu:v1.0
$ docker image ls
REPOSITORY          TAG                 IMAGE ID            CREATED              VIRTUAL SIZE
test/ubuntu         v1.0                9d37a6082e97        About a minute ago   171.3 MB
```

??????????????? URL ???????????????????

```bash
$ docker import http://example.com/exampleimage.tgz example/imagerepo
```

_?????????????? docker load ????????›¥????????????????????? docker import ?????????????????????????????????????????????????????????????§Ö???????????????????????????????????????????????????›¥????????????????????????????????????????????????????????????????????????_

## ???????

??????? `docker container rm` ?????????????????????????????

```bash
$ docker container rm  trusting_newton
trusting_newton
```

???????????????§Ö?????????????? `-f` ??????Docker ???? `SIGKILL` ??????????

## ???????§Õ??????????????

?? `docker container ls -a` ???????????????????????????????????????????????????????????????ú‘????????????????????????§Õ????????????????

```bash
$ docker container prune
```
